✅ Supabase で Server Actions を使用する場合、
NEXT_PUBLIC_SUPABASE_URL や
NEXT_PUBLIC_SUPABASE_ANON_KEY は
クライアントからの利用を前提とした公開キーであり、
ブラウザ側に露出する設計になっている。

そのため、これらのキーを用いて
クライアント側で直接 Supabase の CRUD 操作を行うと、
RLS 設定次第では第三者からの不正アクセスにつながる可能性がある。

また、GOOGLE_API_KEY などの外部 API の秘密鍵は
ブラウザに露出させるべきではない。

以上の理由から、
認可や権限制御を伴う重要な CRUD 処理や
秘密鍵を扱う処理については、
Server Actions または Route Handlers 上で実行する。



✅サーバーアクションズ作成方法
★1
クライアントコンポーネントでNext.js が許可するイベント経由で発火させる場合に使用できる。
単に関数を宣言するだけでは使用できない

発火させる関数の定義を
'use server'を宣言しているファイルに作成し、
そのファイルから関数をクライアントコンポーネントにインポートして使用する
★サーバーアクションを定義するファイルには必ず'use server'を明記する


★2
Supabaseを使う場合、
@supabase/ssr の createServerClient を使用してサーバー用Supabaseクライアントを作成して使用する

createServerClient を使用してのサーバー用Supabaseクライアントのコード例）
import { createServerClient } from '@supabase/ssr'
import { cookies } from 'next/headers'

export async function createClient() {
  const cookieStore = cookies()
  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY!,
    { cookies: cookieStore }
  )
}
）
